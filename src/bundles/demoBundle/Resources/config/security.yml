# Security
security:
    firewalls:
        #  
        #       name secured_area
        #
        #       // FACTORY TOKENS   
        #       http_digest:            # browser window authentication 
        #         private_key:          mykey
        #         realm:                myreal
        #
        #       http_basic              # browser window authentication 
        #         realm:                myreal
        #
        #       sasl:                   # FORM LOCAL
        #         private_key:          mykey
        #         realm:                myreal
        #
        #       // PROVIDER
        #       provider:                   nodefony || in_memory
        #
        #
        #       // CROSS DOMAIN CORS SERVER 
        #       crossDomain: 
        #         allow-origin:         "*" || {"name":"domain", "myName":"mydomain.com"}
        #         Access-Control:       headers to allow in request {access-control-allow-methods :"GET"}      
        #
        #
        demo_area:
            pattern:                    ^/demo
            provider:                   nodefony
            form_login:
              check_path:               /demo/secure
              login_path:               /demo/login  
              default_target_path:      /
            #FACTORY AUTHENTICATION
            sasl:
              private_key:              "Les sanglots longs Des violons De l’automne Blessent mon cœur D’une langueur Monotone."
              realm:                    "nodefony"
            crossDomain: 
                allow-origin:           "*"
                #allow-origin:          {"localhost":"localhost:83", "cci":"mydomain.com"}
                Access-Control:         {
                        "access-control-allow-methods":"GET, POST, PUT, DELETE, OPTIONS",
                        "access-control-allow-headers":"ETag, Authorization,  X-CSRF-Token, X-Requested-With, Accept, Accept-Version, Content-Length, Content-MD5, Content-Type, Date",
                        "access-control-Allow-Credentials":true,
                        "access-control-expose-headers":"WWW-Authenticate ,X-Json",
                        "access-control-max-age":10
                        }
            remember_me:                false           #TODO
            logout:                     /logout
            anonymous:                  ~
            context:                    ~
            stateless:                  false           #TODO
            #redirectHttps:              true

        # passport-basic  DEMO SECURITY AREA 
        basic_area:
            pattern:                    ^/login/passport-http-basic
            provider:                   in_memory
            form_login:
              default_target_path:      /
            passport-basic:
              realm:                    "nodefony"
            logout:                     /logout
            anonymous:                  ~
            context:                    ~

        # passport-digest  DEMO SECURITY AREA 
        digest_area:
            pattern:                    ^/login/passport-http-digest
            provider:                   in_memory
            form_login:
              default_target_path:      /
            passport-digest:
              realm:                    "nodefony"
              private_key:              "Les sanglots longs Des violons De l’automne Blessent mon cœur D’une langueur Monotone."
            logout:                     /logout
            anonymous:                  ~
            context:                    ~

        # passport-local  DEMO SECURITY AREA 
        local_area:
            pattern:                    ^/login/passport-local
            provider:                   in_memory
            form_login:
              login_path:               /login/passport-local
              default_target_path:      /
            passport-local:
              realm:                    "nodefony"
            logout:                     /logout
            anonymous:                  ~
            context:                    ~
            redirectHttps:              true


    #TODO authorisation               
    access_control:
        - { path: ^/admin, roles: ROLE_ADMIN }          #TODO

    providers:
        in_memory:
             memory:
                users:
                    admin: { password: 'admin', roles: 'ROLE_ADMIN' }
                    1000: { password: '1000', roles: 'ROLE_ADMIN' }
        nodefony:
             entity:
                name:   "user"
